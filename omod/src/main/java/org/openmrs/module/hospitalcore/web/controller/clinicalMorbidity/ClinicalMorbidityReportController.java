package org.openmrs.module.hospitalcore.web.controller.clinicalMorbidity;

import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.codehaus.jackson.map.ObjectMapper;
import org.openmrs.api.context.Context;
import org.openmrs.module.hospitalcore.HospitalCoreService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;


@Controller("ClinicalMorbidityReportController")
@RequestMapping("/module/hospitalcore/clinicalMorbidityReport.form")
public class ClinicalMorbidityReportController {
	@RequestMapping(method = RequestMethod.GET)
	public String list( @RequestParam(value = "m", required = true) Integer month,
						@RequestParam(value = "y", required = true) Integer year,
						@RequestParam(value = "w", required = true) String ward,
						Model model, HttpServletRequest request) {

		String[] ageGroupsArray = {"0-29 Days (Neonates)", "Infants", "Under 5", "5 - 11 Years", "11 - 18 Years", "18 - 58 Years", "58 And Above"};  
		String[][] diagnosisMappings = {
			{ "W54.0", "Bites & Stings", "Dogbite", "1067" }, 
			{ "T63, W20-W64", "Bites & Stings", "Other bites, stings and inanimate/animate mechanical force", "1068, 1069, 1241, 1261, 2498" }, 
			{ "T63.00-T63.09", "Bites & Stings", "Snake Bite", "1393" }, 
			{ "I00 -I02", "Cardiovascular", "Acute Rheumatic Fever", "1753" }, 
			{ "I44 - I49", "Cardiovascular", "Cardiac Arrhythmia, Cardiac Block ", "1927" }, 
			{ "I50", "Cardiovascular", "Congetive Cardiac Failure/Heart Failure", "1818, 1466" }, 
			{ "I82", "Cardiovascular", "Deep Vein Thrombosis", "1177" }, 
			{ "I10 - I15, H35.03", "Cardiovascular", "Hypertension and Complications", "1078, 1755, 1154, 1485" }, 
			{ "I20-I25", "Cardiovascular", "Ischemic Heart Diseases (include Angina, Myocardial infartion and complications)", "1457, 1458, 1464, 1465, 1821, 2085" }, 
			{ "I05 - I09", "Cardiovascular", "Rheumatic Heart Disease", "1754, 1097" }, 
			{ "I83, 185, 186", "Cardiovascular", "Vericose Vein ", "1804, 1158, 1392" }, 
			{ "I00-I99", "Cardiovascular ", "Other Cardiovascular Disorder", "1122, 1182, 1385, 1756, 1771, 1779, 1811, 1815, 1816, 1835, 1837, 1838, 1867, 1279, 1950, 2515, 1841" }, 
			{ "I88, L04", "Cardiovascular/Dermatology", "Lymphadnitis", "1164, 1439" }, 
			{ "G80", "CNS", "Cerebral Palsy", "1157" }, 
			{ "G04", "CNS", "Encephalitis", "1843, 2897, 1722, 2901" }, 
			{ "G40 - G47", "CNS", "Epilepsy/Seizure", "1064, 1088, 1928, 2177" }, 
			{ "G81", "CNS", "Hemiperises/Hemiplegia", "1126" }, 
			{ "G91", "CNS", "Hydrocephalus ", "1773" }, 
			{ "G47", "CNS", "Insomnia", "1135" }, 
			{ "G43, G44", "CNS", "Migraine/Cluster Headache", "1260, 1433" }, 
			{ "G00 - G99", "CNS", "Other Nervous System Disorder", "1123, 1125, 1200, 1212, 1250, 1286, 1372, 1400, 1404, 1769, 1842, 1844, 1957, 2111, 2167, 2174, 2885, 2126, 2143, 2047" }, 
			{ "G82", "CNS", "Paraplegia(Paraperesis)/Quadriplegia(Quadriperesis)", "1910" }, 
			{ "G20, G21", "CNS", "Parkinsonism", "1434" }, 
			{ "I63.9", "CNS/Cardiovascular", "Cerebro Vascular Accident (Stroke)", "1254, 1814, 1923" }, 
			{ "H81, R42", "CNS/General", "Vertigo/Dizziness/Giddiness", "1390" }, 
			{ "Q00 - Q99", "Congenital", "Congenital Disorders", "1025, 1201, 1778, 1785, 1786, 1794, 2350, 2351, 1497, 1296, 1334, 1784, 2439, 2440, 1774" }, 
			{ "Q20-Q28", "Congenital/Cardiovascular", "Congenital Heart Disese", "1449" }, 
			{ "K00-K08", "Dental", "Dental Conditions", "1529, 1531, 1533, 1534, 1594, 1595, 1600, 1601, 1602, 1606, 1607, 1616, 1622, 1643, 1644, 1646, 1659, 1661, 2437, 2610, 2612, 1899, 1044, 1220, 1236, 1277, 1599, 1626" }, 
			{ "K02", "Dental", "Dental Caries", "1604, 1610, 1612, 1620, 1624, 1627, 1628, 1631, 1634, 1636, 1639, 1048" }, 
			{ "L70", "Dermatology", "Acne", "1437" }, 
			{ "L02", "Dermatology", "Cutaneous Abscess, Furuncle and Curbuncle", "1035, 1053, 1249" }, 
			{ "L20 - L30", "Dermatology", "Dermatitis and Eczema", "1039, 1040, 1127, 1176, 1515, 1934" }, 
			{ "B02", "Dermatology", "Herpes Zoster and Complications", "1359, 1130" }, 
			{ "L01, L08.0", "Dermatology", "Impetigo/Pyoderma", "1492, 1513" }, 
			{ "L00-L99", "Dermatology", "Other Skin Diseases", "1050, 1134, 1155, 1275, 1460, 1490, 1523, 1768, 1825, 1828, 1861, 1902, 1960, 2100, 2122, 2129, 2611, 1229" }, 
			{ "L29", "Dermatology", "Pruritis", "1138" }, 
			{ "B86", "Dermatology", "Scabies", "1055" }, 
			{ "B35", "Dermatology", "Tinea", "1058, 1129" }, 
			{ "B36.0", "Dermatology", "Tinea Versicolor", "1162" }, 
			{ "L49 - L54", "Dermatology", "Urticaria & Erythemia", "1308" }, 
			{ "L80", "Dermatology", "Vitiligo", "1856" }, 
			{ "B07", "Dermatology", "Wart", "1171, 1436, 1858" }, 
			{ "B72", "Dermatology", "Dracunculosis/Guinea Worm Disease", "2878" }, 
			{ "A09", "Digestive", "Acute Diarrheal Disease (including acute gastroenteritis)", "1081, 1215, 1228" }, 
			{ "K85", "Digestive", "Acute Pancreatitis", "1273" }, 
			{ "K35 - K38", "Digestive", "Appendicitis", "1085" }, 
			{ "K62.5", "Digestive", "Bleeding from Rectum & Anus", "1322" }, 
			{ "K81", "Digestive", "Cholecystitis", "1079" }, 
			{ "K80 - K87", "Digestive", "Disease of Gallbladder, Biliarytract and Pancreas", "3788" }, 
			{ "K70 - K77", "Digestive", "Disease of Liver ", "3789" }, 
			{ "K09-K14", "Digestive", "Diseases of Oral Cavity and Salivary Glands", "1642, 1603, 1192, 1199, 1218, 1230, 1253, 1459, 1475, 1476, 1477, 1510, 1592" }, 
			{ "K60, N82", "Digestive", "Fissure/Fistula of Anus, Rectum etc", "1173, 1388, 1237, 1350" }, 
			{ "K56", "Digestive", "Intestinal Obstruction", "1248, 1809" }, 
			{ "K50 - K52", "Digestive", "Noninfective Gastroenteritis and Colitis (inlcuding Crohn's Dsease and Ulcerative Colitis)", "1831" }, 
			{ "K70 - K77", "Digestive", "Other Diseases of Liver Including Chronic Liver Disease/Cirrhosis and Liver Failure", "1467, 1468" }, 
			{ "K85, K86", "Digestive", "Pancreatitis", "1665" }, 
			{ "K27", "Digestive", "Peptic Ulcer", "1090, 1091, 1092" }, 
			{ "K65", "Digestive", "Peritonitis", "1282" }, 
			{ "B67", "Digestive", "Hydated Cyst of Liver", "1363" }, 
			{ "K80", "Digestive ", "Cholelithiasis/Gallstone", "1329" }, 
			{ "K29", "Digestive ", "Gastritis/Duodenitis", "1217, 1219, 1795, 1071" }, 
			{ "K64", "Digestive ", "Haemorrhoids/Piles", "1337" }, 
			{ "K40 - K46", "Digestive ", "Hernia", "1231, 1240, 1305, 1341, 1376" }, 
			{ "K14 - K95", "Digestive ", "Other GIT Disorder", "1178, 1469, 1832, 2096, 2118, 2123, 2148" }, 
			{ "R12", "Digestive/General", "Heartburn", "1940, 1033" }, 
			{ "A06", "Digestive/Infectious", "Dysentery Amoebic/Amoebiasis", "1672, 1003, 1233, 1677, 1042" }, 
			{ "B37", "Digestive/Infectious", "Oral Candidiasis", "1198" }, 
			{ "A03", "Digestive/Infectious", "Dysentery Bacillary", "1668, 2894" }, 
			{ "A03, A06", "Digestive/Infectious", "Dysentery ", "2450" }, 
			{ "E00 ", "Endocrine,Metabolic, Nutritional etc", "Cretenism", "2892" }, 
			{ "E84", "Endocrine,Metabolic, Nutritional etc", "Cystic Fibrosis", "1826" }, 
			{ "E00 - E07", "Endocrine,Metabolic, Nutritional etc", "Other Disorder of Thyroid Gland", "1478, 1247, 1190" }, 
			{ "E86", "Endocrine,Metabolic, Nutritional etc", "Dehydration", "1161" }, 
			{ "E10", "Endocrine,Metabolic, Nutritional etc", "Diabetes Mellitus Type 1", "1413" }, 
			{ "E11", "Endocrine,Metabolic, Nutritional etc", "Diabetes Mellitus Type 2", "1414" }, 
			{ "E04", "Endocrine,Metabolic, Nutritional etc", "Endemic Goiter and Other Iodine Deficinecy Disorder", "1049, 2900" }, 
			{ "E05.9", "Endocrine,Metabolic, Nutritional etc", "Hyperthyroidism Unspecified", "1847" }, 
			{ "E03.9", "Endocrine,Metabolic, Nutritional etc", "Hypothyroidism Unspecified", "1431, 1432" }, 
			{ "E40-E46", "Endocrine,Metabolic, Nutritional etc", "Malnutrition", "1762, 1765, 1766, 3011" }, 
			{ "E8 - E13", "Endocrine,Metabolic, Nutritional etc", "Other Diabetes Mellitus (Include Complication)", "1338, 1484, 1846" }, 
			{ "E00 - E89", "Endocrine,Metabolic, Nutritional etc", "Other Endocrine, Metabolic & Nutrional diseases", "1800, 1100, 1462, 2093, 2107" }, 
			{ "E52", "Endocrine,Metabolic, Nutritional etc", "Pellagra", "1108" }, 
			{ "E50", "Endocrine,Metabolic, Nutritional etc", "Vitamin A Deficiency", "1396" }, 
			{ "E51-E53", "Endocrine,Metabolic, Nutritional etc", "Vitamin B Deficiency", "1514" }, 
			{ "E55", "Endocrine,Metabolic, Nutritional etc", "Vitamin D Deficiency", "1142, 1194" }, 
			{ "E56.9", "Endocrine,Metabolic, Nutritional etc", "Vitamin Deficiency Unspecified", "3790" }, 
			{ "E66", "Endocrine,Metabolic, Nutritional etc", "Overweight/Obesity", "1463" }, 
			{ "E50-E64", "Endocrine,Metabolic, Nutritional etc", "Other Nurtitional Deficiency", "3791" }, 
			{ "E54", "Endocrine,Metabolic, Nutritional etc", "Vitamin C Deficiency/Scurvy", "1143" }, 
			{ "J34.2", "ENT", "Deviated Nasal Septum (DNS)", "1342" }, 
			{ "H90", "ENT", "Hearing Loss (Conductive/Sensorineural)", "1820, 1822, 1823, 3009, 1370, 1479" }, 
			{ "R49", "ENT", "Hoarseness", "1346" }, 
			{ "H60", "ENT", "Otitis Externa", "2116, 2486, 1095" }, 
			{ "H65 - H67", "ENT", "Otitis Media", "1280, 1335, 1473" }, 
			{ "H92", "ENT", "Otorrhea/Otalgia", "1137" }, 
			{ "H93.1", "ENT", "Tinnitis ", "1438" }, 
			{ "H61.2", "ENT", "Wax in Ear", "1118" }, 
			{ "J04.0", "ENT/Respiratory", "Acute Laryngitis", "1221, 1128" }, 
			{ "J03, J36", "ENT/Respiratory", "Acute Tonsillitis/Abscess Tonsil", "1216, 2490, 1034" }, 
			{ "J02", "ENT/Respiratory", "Acute Pharangitis", "1234" }, 
			{ "J31.2", "ENT/Respiratory", "Chronic Pharangitis", "1302" }, 
			{ "H60 - H95, J30 - J39", "ENT/Respiratory", "Other ENT Disorder", "1493, 1830, 1119, 1440, 1472, 1791, 1827, 1290, 1793, 1471" }, 
			{ "J01, J32", "ENT/Respiratory", "Sinusitis (Acute/Chronic)", "1098, 1303, 1912, 1244" }, 
			{ "J35", "ENT/Respiratory", "Tonsilar Hypertrophy/Chronic Tonsillitis", "2438, 1193" }, 
			{ "J30", "ENT/Respiratory", "Allergic/Vasomotor Rhinitis", "1139, 1480, 1976" }, 
			{ "J00 - J06", "ENT/Respiratory", "Acute Upper Respiratory Tract Infection", "1441, 1243, 1149, 3012, 1512" }, 
			{ "H54", "Eye", "Blindness & Low Vision", "3006" }, 
			{ "H25 - H26", "Eye", "Cataract", "1023" }, 
			{ "H10", "Eye", "Conjuntivitis", "1038, 1483, 1489" }, 
			{ "H16-H18", "Eye", "Other Corneal Disorder", "1256, 1790, 1920" }, 
			{ "H52", "Eye", "Eye Refraction Disorder include Myopia, Presbyiopia, Hypermetropia etc.", "1382, 1453, 1454, 1488" }, 
			{ "H40 - H42", "Eye", "Glaucoma", "1304" }, 
			{ "H30 - H36", "Eye", "Other Choroid and Retina Disorder", "1384, 1422, 1423, 1429, 1482, 2889" }, 
			{ "H00-H59", "Eye", "Other Eye Disorder", "1165, 1289, 1301, 1394, 1417, 1418, 1419, 1420, 1421, 1424, 1425, 1427, 1428, 1430, 1451, 1455, 1461, 2079, 2446, 1819" }, 
			{ "H11.0", "Eye", "Pterygium", "1381" }, 
			{ "H00", "Eye", "Stye/Chalazion", "1150, 1348" }, 
			{ "H16.0, H17", "Eye", "Corneal Ulcer/Opacities", "1408, 1426" }, 
			{ "A71", "Eye/Infection", "Trachoma", "1369" }, 
			{ "R22", "General", "Localized swelling, mass and lump", "1922" }, 
			{ "R10.9", "General", " Pain Unspecified", "1063, 1110, 1456, 1664, 1908, 2476, 2484" }, 
			{ "R63.5", "General", "Abnormal Weight Gain", "3792" }, 
			{ "R63.4", "General", "Abnormal Weight Loss", "3793" }, 
			{ "R10.0", "General", "Acute Abdomen", "1224, 1225" }, 
			{ "T78", "General", "Anaphylactic Reaction", "3794" }, 
			{ "R63.0", "General", "Anorexia", "1136" }, 
			{ "R18, K70.31, K70.11, K71.51", "General", "Ascitis", "1120" }, 
			{ "R26, R27", "General", "Ataxia", "1116" }, 
			{ "Z20", "General", "Contact with or suspected exposure to communicable diseases (STI, TB etc)", "1788" }, 
			{ "R05", "General", "Cough", "1901" }, 
			{ "R40", "General", "Drowsiness & Coma", "3795" }, 
			{ "T50", "General", "Drug Toxicity", "1026, 1029, 1106" }, 
			{ "R13", "General", "Dysphagia/Aphagia", "1204, 2158, 1140" }, 
			{ "R30.0", "General", "Dysurea", "1210" }, 
			{ "R60", "General", "Edema", "1121" }, 
			{ "R04", "General", "Epistaxis", "1072" }, 
			{ "R62.51,R 62.7", "General", "Failure to Thrive/Gain Weight", "1187" }, 
			{ "R51", "General", "Headache", "1330" }, 
			{ "R31", "General", "Hematuria", "1133" }, 
			{ "Z91.81", "General", "History of Falling", "2468" }, 
			{ "R10.83", "General", "Infantile Colic", "1450" }, 
			{ "R17", "General", "Jaundice NOS", "1093" }, 
			{ "R41.3", "General", "Memory Disorder ", "2507" }, 
			{ "R00 - R99", "General", "Other General", "1474, 1761, 2068, 2146" }, 
			{ "R52", "General", "Pain (Unspecified)", "3796" }, 
			{ "R55", "General", "Syncope/Blackout/Fainting", "1386" }, 
			{ "R32, R39.81", "General", "Urinary Incontinence", "1834" }, 
			{ "R53.1-R53.8", "General", "Weakness/Tiredness", "1191" }, 
			{ "R50", "General", "Fever of Unknown Origin/PUO", "1152" }, 
			{ "T78", "General ", "Other Allergies", "1057" }, 
			{ "R56.0", "General/CNS", "Febrile Convulsion", "1349" }, 
			{ "N17", "Genitourinary", "Acute Renal Failure", "1239" }, 
			{ "N40", "Genitourinary", "Benign Prostatic Hypertropy  ", "1287, 1781" }, 
			{ "N63", "Genitourinary", "Breast Nodule/Lump NOS", "1327" }, 
			{ "N18", "Genitourinary", "Chronic Renal Failure", "1331" }, 
			{ "N00 - N08", "Genitourinary", "Glomerular Diseases", "1787" }, 
			{ "N43", "Genitourinary", "Hydrocele", "1352" }, 
			{ "N61", "Genitourinary", "Inflammatory Disorder of Breast", "1326, 1036" }, 
			{ "N04", "Genitourinary", "Nephrotic Syndrome", "1264" }, 
			{ "N60 - N65", "Genitourinary", "Other Breast Disorder", "1328, 1508, 2434" }, 
			{ "N00-N99", "Genitourinary", "Other Genitourinary Disorder", "1107, 1184, 1226, 1238, 1298, 1300, 1318, 1379, 1447, 1494, 1783, 1829, 1836, 1890, 2101, 2513, 2076 " }, 
			{ "N47", "Genitourinary", "Phimosis/Paraphimosis", "1109" }, 
			{ "N23", "Genitourinary", "Renal Colic", "1377, 1383" }, 
			{ "N39.0", "Genitourinary", "Urinary Tract Infection", "1017" }, 
			{ "N20-N23", "Genitourinary", "Urolithiasis", "1263, 1760" }, 
			{ "N94.4 - N94.6", "Gynaecology", "Dysmenorrhoea", "1045" }, 
			{ "N70-N99", "Gynaecology", "Other Gynaecological Disorder", "1009, 1062, 1343, 1312, 1442, 1443, 1444, 1445, 1446, 1487, 1504, 1507, 1810, 1851, 1855, 2430, 1311, 1320, 1321, 1115, 1208, 1223, 1232, 1235, 1378" }, 
			{ "D25", "Gyneclology/Neoplasm", "Uterine Fibroid", "1319" }, 
			{ "N91", "Gynecology", "Amenorrhoea", "1500, 1501" }, 
			{ "N81", "Gynecology", "Female Genital Prolapse", "1852" }, 
			{ "N92", "Gynecology", "Menorrhagia", "2491, 1259" }, 
			{ "N83.20", "Gynecology", "Ovarian Cyst Unspecified", "1272" }, 
			{ "N93.9", "Gynecology", "Uterine and Vaginal Bleeding, Unspecified", "1323" }, 
			{ "N76, B37.3", "Gynecology", "Vaginitis/Vulvitis", "1054, 1103, 1387, 1317" }, 
			{ "N89.8", "Gynecology", "Leucorrhoea", "1448" }, 
			{ "N70-N77", "Gynecology/STI", "Female Pelvic Inflamatory Diseases", "1153" }, 
			{ "D50-D64", "Haematology", "Anemia", "996, 997, 998, 1175" }, 
			{ "D50 - D89", "Haematology", "Other Diseases of Blood & Blood Forming Organs & Certain Disorders Involving Immune Mechanism", "1972, 2060, 2063, 2073, 1503, 1886, 2040" }, 
			{ "D69", "Haematology", "Purpura and other hemorrhagic conditions including Thrombocytopenia", "1132, 1864" }, 
			{ "A22", "Infectious", "Anthrax", "1710" }, 
			{ "A36", "Infectious", "Diphtheria", "1713" }, 
			{ "B20", "Infectious", "HIV/AIDS", "1148, 1197, 1749, 1775, 1797, 1863" }, 
			{ "B05", "Infectious", "Measles", "1020" }, 
			{ "A00 - B99", "Infectious", "Other Infectious & Parasitic Diseases", "1160, 1186, 1172, 1065, 1070, 1087, 1104, 1174, 1185, 1297, 1435, 1706, 1744, 1751, 1805, 1666, 1745, 1678" }, 
			{ "A20", "Infectious", "Plague", "1709" }, 
			{ "R65.2, A41.9", "Infectious", "Septicemia/Severe Sepsis", "1397" }, 
			{ "A15-A19", "Infectious", "Tuberculosis", "1010, 1163, 1707, 1708, 1752, 1245, 1213, 1525, 1527, 1470" }, 
			{ "B65 - B83", "Infectious", "Worm Infestation", "1083" }, 
			{ "A27", "Infectious", "Leptopirosis", "1711" }, 
			{ "A80", "Infectious/CNS", "Acute Flacid Paralysis (under 15 years of age)", "1195, 2899" }, 
			{ "A39.0", "Infectious/CNS", "Meningitis Meningococcal", "1518" }, 
			{ "G00 - G03, B45", "Infectious/CNS", "Meningitis Unspecified", "1167, 1179, 1019, 1723" }, 
			{ "A82", "Infectious/CNS", "Rabies", "1517" }, 
			{ "A35", "Infectious/CNS", "Tetanus (Exclude Neonatal Tetanus)", "1521" }, 
			{ "A87", "Infectious/CNS", "Meningitis Viral", "1714" }, 
			{ "B01", "Infectious/Dermatology", "Chicken Pox", "1146" }, 
			{ "A30", "Infectious/Dermatology", "Leprosy", "1144" }, 
			{ "B00", "Infectious/Dermatology", "Herpes Simplex", "1339" }, 
			{ "B26", "Infectious/Digestive", "Mumps", "1021, 1181" }, 
			{ "A00", "Infectious/Digestive", "Cholera (laboratory confirmed)", "1082" }, 
			{ "A01", "Infectious/Digestive", "Enteric Fever (Typhoid)", "1056" }, 
			{ "B15", "Infectious/Digestive", "Viral Hepatitis A", "1005, 1746, 2524" }, 
			{ "B15 -B19 / K70-K77", "Infectious/Digestive ", "Hepatitis Unspecified", "1748, 1008, 2527, 1505" }, 
			{ "B16, B18", "Infectious/Digestive ", "Viral Hepatitis B", "2525, 1006, 1747" }, 
			{ "B17.1, B18", "Infectious/Digestive ", "Viral Hepatitis C", "1007, 2526" }, 
			{ "B17.2", "Infectious/Digestive ", "Viral Hepatitis E", "2528, 1506" }, 
			{ "R59", "Infectious/General", "Cervicle Lymphadenopathy", "1189" }, 
			{ "A37", "Infectious/Respiratory", "Whooping Cough/Pertusis", "1145" }, 
			{ "J09 - J11", "Infectious/Respiratory", "Infuenza", "1802" }, 
			{ "J09.X2", "Infectious/Respiratory", "Swineflu (H1N1)", "2508" },
			{"U07.1", "Infectious/Respiratory", "COVID-19", "3810"}, 
			{ "V00-X58", "Injuries, Poisoning etc", "Accident Traffic", "1028" }, 
			{ "X92.0-X92.9", "Injuries, Poisoning etc", "Accidental Drowning", "3010" }, 
			{ "X97-Y04", "Injuries, Poisoning etc", "Assault (no weapon)", "3797" }, 
			{ "X93-X96", "Injuries, Poisoning etc", "Assault (with weapon)", "3013" }, 
			{ "T20-T32", "Injuries, Poisoning etc", "Burns and Corrosions", "1051" }, 
			{ "T14.91", "Injuries, Poisoning etc", "Self Harm", "3007" }, 
			{ "L08.9, T81.4", "Injuries, Poisoning etc", "Infected Wound", "1031" }, 
			{ "T74.2 & T76.2", "Injuries, Poisoning etc", "Sexual Assault/Abuse", "1066" }, 
			{ "T36 - T50", "Injuries, Poisoning etc", "Poisoning", "1524, 1938" }, 
			{ "T15-T19", "Injuries, Poisoning etc", "Entrance of Foreignbody through Natural Orifice", "1344, 1345, 1347" }, 
			{ "V00-X58 ", "Injuries, Poisoning etc", "Other Accidents", "1027, 2888" }, 
			{ "S00-T88", "Injuries, Poisoning etc", "Other Injuries", "1452, 1770, 1772, 1906, 1969, 2038, 1032, 1401, 1402, 1043, 1046, 1061, 1084, 2339, 2342, 2342, 2471, 2147, 1258, 1265, 1266, 1267" }, 
			{ "M02, M13, M19", "Musculoskeletal", "Arthritis Other", "1037, 1803" }, 
			{ "S01-S99", "Musculoskeletal", "Dislocation and Sprain", "2340, 1112, 1486, 1798, 1801, 1904, 2542, 1076, 2036" }, 
			{ "M10", "Musculoskeletal", "Gouty Arthritis", "1324, 1491" }, 
			{ "M15 - M19", "Musculoskeletal", "Osteoarthritis", "1268" }, 
			{ "M80 - M81", "Musculoskeletal", "Osteoporosis with or witout Fracture", "1271" }, 
			{ "M00-M99", "Musculoskeletal", "Other Musculoskeletal Disorder", "1776, 1777, 1055, 1246, 1262, 1306, 1316, 1336, 1340, 1351, 1368, 1395, 1403, 1782, 1909, 1911, 1913, 1917, 2344, 2345, 2348, 2349, 2428, 2429, 2467, 2517, 2114, 2156, 1663, 1824, 1196" }, 
			{ "M00", "Musculoskeletal", "Pyogenic Arthritis", "1278, 2541, 2499" }, 
			{ "M05, M06", "Musculoskeletal", "Rhematoid Arthritis", "1086" }, 
			{ "M45-M49", "Musculoskeletal", "Spondylopathies", "1156, 1242, 1255, 1389, 1391, 2346, 2352" }, 
			{ "M86", "Musculoskeletal", "Acute Osteomyelitis", "1269" }, 
			{ "M86", "Musculoskeletal", "Chronic Osteomyelitis", "1270" }, 
			{ "S01-S99", "Musculoskeletal/Injuries, Poisoning etc", "Fractures", "1332, 1333, 1406, 2340, 2343, 2347, 1074, 1075, 1945, 1952, 1954, 1962, 1970, 1973, 1977, 1978, 1987, 1990, 1994, 1997, 2002, 2006, 2010, 2015, 2018, 2022, 2023, 2025, 2034, 2039, 2041, 1598, 1597" }, 
			{ "C50", "Neoplasm", "Ca Breast", "1679" }, 
			{ "C34", "Neoplasm", "Ca Bronchus/Lung", "1698" }, 
			{ "C53", "Neoplasm", "Ca Cervix", "1361" }, 
			{ "C22", "Neoplasm", "Ca Liver", "1683" }, 
			{ "C15", "Neoplasm", "Ca Oesophagus", "1705" }, 
			{ "C00-C14", "Neoplasm", "Ca Oral Cavity", "1704, 2435" }, 
			{ "C16", "Neoplasm", "Ca Stomach", "1680" }, 
			{ "C54", "Neoplasm", "Ca Uterus", "2456" }, 
			{ "D10 - D36", "Neoplasm", "Neoplasm Benign", "1692, 2152, 2432, 2433" }, 
			{ "C00-D49 ", "Neoplasm", "Other Neoplasm", "1807, 1808, 1024, 1094, 1117, 1183, 1257, 1291, 1293, 1325, 1362, 1364, 1365, 1366, 1367, 1481, 1528, 1681, 1682, 1685, 1687, 1689, 1694, 1696, 1697, 1701, 1702, 1703, 1812, 1840, 1848, 1849, 1850, 1894, 1894, 1930, 2057, 2067, 2295, 2464, 2483, 1859" }, 
			{ "C58", "Neoplasm/Obstetrics", "Choriocarcinoma", "1354" }, 
			{ "D32.9", "Neoplasm/Obstetrics", "Malignant Hydatidiform Mole ", "1358" }, 
			{ "F10-F19", "Psychiatric, Behavioral, Neurodevelopmental", "Alcohol or Other Subtance Use Disorder", "1409, 1415, 1416" }, 
			{ "F30 - F39", "Psychiatric, Behavioral, Neurodevelopmental", "Mood Disorder (Mania, Bipolar, Major Depression)", "1915" }, 
			{ "F01-F99", "Psychiatric, Behavioral, Neurodevelopmental", "Other Psychiatric, Behavioral, Neurodevelopmental Disorder", "1862, 1868, 1813, 2157, 1495" }, 
			{ "F20 - F29", "Psychiatric, Behavioral, Neurodevelopmental", "Psychotic Disorder including Schzophrenia", "1096, 1111, 2887" }, 
			{ "F01-F03, G30, G31", "Psychiatric, Behavioral, Neurodevelopmental/CNS", "Dementia", "1188, 2043" }, 
			{ "F03, G31", "Psychiatric, Behavioral, Neurodevelopmental/CNS", "Senile Dementia", "1114" }, 
			{ "F70-F79 ", "Psychiatric, Behavioral, Neurodevelopmental/CNS", "Mental Retardation/Intellectual Disability", "1845, 2044" }, 
			{ "F40 - F48", "Psychiatric, Behavioral, Neurodevepmental", "Anxiety, Dissociative, Stress related, Somatic & Other Non-Psychotic-Mental Disorders", "1399, 1360, 2886" }, 
			{ "J45", "Respiratory", "Asthma", "999, 1000, 1281, 1926" }, 
			{ "J47", "Respiratory", "Bronchiectasis", "1799" }, 
			{ "J40 - J47", "Respiratory", "Chronic Lower Respiratory Tract Infection including Chronic Bronchitis and Emphysema", "1180, 1407, 1498, 1522" }, 
			{ "J20 - J21", "Respiratory", "Acute Bronchitis/Bronchiolitis", "1001, 1060, 1222" }, 
			{ "J12 - J18", "Respiratory", "Pneumonia & Bronchopneumonia", "1011, 1080, 1113, 1141, 1168, 1285, 1796, 1866" }, 
			{ "J00-J99", "Respiratory/ENT", "Other Respiratory Disorder", "1227, 1315, 2898" }, 
			{ "??", "Services", "Physiotherapy", "3798" }, 
			{ "Z00-Z99", "Services", "Person Encountering Health Services for Dressing, Injection and Other Services", "3799" }, 
			{ "Z00-Z13", "Services", "Person Encountering Health Services for Examination", "1502" }, 
			{ "Z30-Z39", "Services", "Persons Encountering Health Services in Circumstances Related to Reproduction ", "3800" }, 
			{ "A54", "STI", "Gonococcus Infection", "1147" }, 
			{ "A60", "STI", "Herpes Simplex (Ano-genital)", "1355, 1721" }, 
			{ "A50-A64", "STI", "Other Sexually Transmitted Infection (STI)", "1073" }, 
			{ "A50 - A53", "STI", "Syphilis", "1099, 1751, 1716, 1717, 1718" }, 
			{ "A56, A59", "STI", "Chlamydia/Trichomonas Valvovaginitis, Cystitis, Urethritis", "1371" }, 
			{ "A55, A57, A58", "STI", "Genital Ulcer (Chancroid, Granuloma Inguinale/Donovanosis, Lymphogranuloma Venerum)", "1295, 1719, 1720" }, 
			{ "R36,  A50-A64", "STI/General", "Urethral Discharge", "1209" }, 
			{ "A92.0", "Vector borne", "Chickungunya", "2895" }, 
			{ "A90 - A91", "Vector borne", "Dengue/DHF/DSS/Yellow Fever", "1018, 1724, 1743, 2896" }, 
			{ "B74", "Vector borne", "Filariasis", "1750" }, 
			{ "A83.0", "Vector borne", "Japanese Encephalitis", "2879" }, 
			{ "B55", "Vector borne", "Kala Azar/Leishmaniasis", "2891, 2893" }, 
			{ "B50 - B54", "Vector borne", "Malaria", "1041" }, 
			{ "P07", "Newborn", "Low Birth Weight", "1865" }, 
			{ "P36", "Newborn", "Umbilical Sepsis/Bacterial Sepsis of New Born", "1496" }, 
			{ "P00 - P96", "Newborn", "Other Newborn conditions effected during perinatal period", "1965, 1806, 1857, 1860" }, 
			{ "A33", "Newborn", "Tetanus Neonatorum", "1519, 1712" }, 
			{ "P10 - P15", "Newborn", "Birth Trauma to Newborn", "1780" }, 
			{ "P22", "Newborn", "Respiratory Distress of Newborn", "3801" }, 
			{ "O00", "Obstetrics", "Ectopic Pregnancy (include ruptured ectopic pregnancy)", "1013, 1410" }, 
			{ "O10 - O16", "Obstetrics", "Edema, Protenuria, and Hypertensive Disorder in Pregnancy, Childbirth & Puerperium", "1014" }, 
			{ "O03", "Obstetrics", "Spontaneous Abortion", "1015, 1398" }, 
			{ "O72", "Obstetrics", "Postpartum Hemorrhage  (PPH)", "1016" }, 
			{ "O85 - O86", "Obstetrics", "Puerperal Sepsis & Other Puerperal Infections", "1047, 2066" }, 
			{ "O44, O45, O20", "Obstetrics", "Antepartum Hemorrhage (Placenta Previa/Abruptio Placenta and others)", "1102, 1214, 1284" }, 
			{ "O00 - O9A", "Obstetrics", "Other Maternal  & Obstetric Conditions Not Specified ", "1251, 1252, 1307, 1312, 1817, 1919" }, 
			{ "O60 - O77", "Obstetrics", "Other Complication of Labour and Delivery", "1853, 1276" }, 
			{ "O44", "Obstetrics", "Placenta Previa", "3802" }, 
			{ "O10.0", "Obstetrics", "Pre-existing Essential Hypsertension Complicating Pregnancy", "3803" }, 
			{ "O14 - O15", "Obstetrics", "Pre-Eclampsia/Eclampsia", "1292, 1411" }, 
			{ "O21", "Obstetrics", "Excessive Vomitting in Pregnancy", "2455, 1353" }, 
			{ "O00 - O08", "Obstetrics", "Other Pregnancy Conditions with Abortive Outcome (include Hydatidform Mole)", "2463, 2470, 1309, 1310, 1313, 1314, 1356, 1357" }, 
			{ "O04", "Obstetrics", "Complication Following (Induced) Termination of Pregnancy", "3804" }, 
			{ "O60", "Obstetrics", "Preterm Labour", "2492" }, 
			{ "O63", "Obstetrics", "Prolong Labour", "3805" }, 
			{ "O64 - O65", "Obstetrics", "Obstrcted Labour", "3806" }, 
			{ "O85 - O86", "Obstetrics", "Other Complication Predominantly Related to Puerperium", "3807" }, 
			{ "O98", "Obstetrics", "Maternal Infections, Parasitic Diseases Classified Elsewhere but Complicating Pregnancy, Childbirth and Puerperium", "2522" }, 
			{ "O24", "Obstetrics", "Diabetes Mellitus in Pregnancy, Childbirth and Puerperium", "3808" }, 
			{ "O25", "Obstetrics", "Malnutrition in Pregnancy, Childbirth and Puerperium", "2537" }, 
			{ "O99.0", "Obstetrics", "Anemia Complicating Pregnancy, Childbirth and Puerperium", "3809" }, 
			{ "", "Obstetrics", "Malpresentation of Fetus", "1294" }, 
			{ "", "Obstetrics", "Multiple Gestation", "1299, 2466" }, 
			{ "", "Obstetrics", "Twin Pregnancy", "1924" }, 
			{ "O33", "Obstetrics", "Maternal Care for Disproportion including Cephalo-pelvic Disproportion", "2436" }, 
			{ "", "Obstetrics", "Teenage Pregnancy", "2511" }, 
			{ "", "Obstetrics", "Grand Multipara", "2466" }, 
			{ "", "Obstetrics", "Early Pregnancy", "2451" }, 
			{ "Z32.0, Z33", "Obstetrics", "Encounter for Pregnacy Test/Pregnancy State", "1012" }, 
			{ "Z31.82", "Obstetrics", "Encounter for Rh Incompatibility Status ", "1405" }, 
			{ "O47.9", "Obstetrics", "False Labour", "1151" }, 
			{ "", "Obstetrics/Newborn", "Breech Delivery", "1170" }
		};
		
		HospitalCoreService hcs= Context.getService(HospitalCoreService.class);
		List<Map<String, Object>> numberOfPatientsWithAgeGroupList = hcs.getNumberOfPatientsWithAgeGroups(month, year, ward);
		

		// Converting Java list to json.
		ObjectMapper mapper = new ObjectMapper();
		String diagnosisListJson = "";
		String ageGroupsJson = "";
		String numberOfPatient = "";
		
		try {
			diagnosisListJson = mapper.writeValueAsString(diagnosisMappings);
			ageGroupsJson = mapper.writeValueAsString(ageGroupsArray);
			numberOfPatient = mapper.writeValueAsString(numberOfPatientsWithAgeGroupList);
	
		} catch (Exception e) {
			e.printStackTrace();
		}
	
		model.addAttribute("diagnosisListJson", diagnosisListJson);
		model.addAttribute("ageGroupsJson", ageGroupsJson);
		model.addAttribute("numberOfPatient", numberOfPatient);
		model.addAttribute("ward", ward);
    	
    	return "/module/hospitalcore/clinicalMorbidityHIS/clinicalMorbidityReport";
	}
}